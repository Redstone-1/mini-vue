{"version":3,"file":"vue.js","sources":["../../src/utils/index.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function isObject (target) {\n  return typeof target === 'object' && target !== null;\n}\n\nexport function def(data, key, value) {\n  Object.defineProperty(data, key, {\n    value: value,\n    enumerable: false,\n    configurable: false,\n  })\n}","\n\nlet oldArrayMethods = Array.prototype;\nexport const arrayMethods = Object.create(oldArrayMethods)\n\nconst methods = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'reverse',\n  'sort',\n  'splice'\n]\n\nmethods.forEach(method => {\n  arrayMethods[method] = function (...args) {\n    const result = oldArrayMethods[method].apply(this, args);\n    console.log('method>>>>>', method);\n    let inserted;\n    let ob = this.__ob__;\n\n    switch (method) {\n      case 'push':\n        inserted = args;\n        break;\n      case 'unshift':\n        inserted = args;\n        break;\n      case 'spilice':\n        inserted = args.slice(2)\n        break;\n      default:\n        break;\n    }\n\n    if (inserted) {\n      ob.observerArray(inserted);\n    }\n\n    return result;\n  }\n})","import { isObject, def } from \"../utils/index\";\nimport { arrayMethods } from \"./array\";\n\nexport function observe(data) {\n  if (!isObject(data)) {\n    return\n  }\n\n  new Observer(data);\n}\n\nclass Observer {\n  constructor(values) {\n    def(values, '__ob__', this);\n    \n    if (Array.isArray(values)) {\n      values.__proto__ = arrayMethods;\n      this.observerArray(values);\n    } else {\n      this.walk(values);\n    }\n  }\n  walk(data) {\n    let keys = Object.keys(data);\n    keys.forEach((key) => {\n      // 定义响应式数据\n      defineReactive(data, key, data[key]);\n    })\n  }\n\n  observerArray(data) {\n    for (let i = 0; i < data.length; i++) {\n      observe(data[i]);\n    }\n  }\n}\n\nfunction defineReactive (data, key, value) {\n  observe(value); // 如果对象属性也是对象，递归劫持\n  Object.defineProperty(data, key, {\n    get() {\n      return value\n    },\n    set(newValue) {\n      if (newValue === value) return;\n      observe(newValue); // 如果用户给对象从新赋值，劫持新值\n      value = newValue;\n    }\n  })\n}","import { observe } from './observer/index';\n\nexport function initState (vm) {\n  const options = vm.$options;\n  console.log('options>>>>>', options);\n  if (options.props) {\n    initProps(vm);\n  }\n  if (options.methods) {\n    initMethods(vm);\n  }\n  if (options.data) {\n    initData(vm);\n  }\n  if (options.computed) {\n    initComputed(vm);\n  }\n  if (options.watch) {\n    initWatch(vm);\n  }\n}\n\nfunction initProps(vm) {\n  \n}\n\nfunction initMethods(vm) {\n\n}\n\nfunction initData(vm) {\n  const { $options } = vm;\n  let data = $options.data;\n  data = vm._data = typeof data === \"function\" ? data.call(vm) : data;\n  // 数据劫持\n  observe(data)\n}\n\nfunction initComputed(vm) {\n\n}\n\nfunction initWatch(vm) {\n\n}\n\n","import { initState } from \"./state\";\n\nexport function initMixin (Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this;\n    vm.$options = options;\n    // 初始化状态\n    initState(vm)\n  }\n}","import { initMixin } from './init.js';\n\nfunction Vue(options) {\n  this._init(options)\n}\n\ninitMixin(Vue)\n\nexport default Vue;"],"names":["isObject","target","def","data","key","value","Object","defineProperty","enumerable","configurable","oldArrayMethods","Array","prototype","arrayMethods","create","methods","forEach","method","args","result","apply","console","log","inserted","ob","__ob__","slice","observerArray","observe","Observer","values","isArray","__proto__","walk","keys","defineReactive","i","length","get","set","newValue","initState","vm","options","$options","props","initData","computed","watch","_data","call","initMixin","Vue","_init"],"mappings":"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"}